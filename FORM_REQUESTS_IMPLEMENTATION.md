# ‚úÖ Form Request Classes - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã

## üéØ –ó–∞–¥–∞—á–∞

–í—ã–Ω–µ—Å—Ç–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ Form Request –∫–ª–∞—Å—Å—ã –¥–ª—è:
- –ë–æ–ª–µ–µ —á–∏—Å—Ç—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –ö–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω—ã Form Request –∫–ª–∞—Å—Å—ã

```
app/Http/Requests/
‚îú‚îÄ‚îÄ StoreEventRequest.php           ‚úÖ
‚îú‚îÄ‚îÄ UpdateEventRequest.php          ‚úÖ
‚îú‚îÄ‚îÄ StoreTripRequest.php            ‚úÖ
‚îú‚îÄ‚îÄ UpdateTripRequest.php           ‚úÖ
‚îú‚îÄ‚îÄ StoreBookingRequest.php         ‚úÖ
‚îî‚îÄ‚îÄ UpdateBookingStatusRequest.php  ‚úÖ
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Form Request

–ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å —Å–æ–¥–µ—Ä–∂–∏—Ç:

#### `authorize()` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```php
public function authorize(): bool
{
    return true; // –î–ª—è API –æ–±—ã—á–Ω–æ true, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ middleware
}
```

#### `rules()` - –ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```php
public function rules(): array
{
    return [
        'title' => 'required|string|max:255',
        'date_start' => 'required|date',
        'date_end' => 'required|date|after:date_start',
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
    ];
}
```

#### `attributes()` - –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π
```php
public function attributes(): array
{
    return [
        'title' => '–Ω–∞–∑–≤–∞–Ω–∏–µ',
        'date_start' => '–¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞',
        'date_end' => '–¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è',
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
    ];
}
```

#### `messages()` - –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```php
public function messages(): array
{
    return [
        'date_end.after' => '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞',
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    ];
}
```

## üìã –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### StoreEventRequest

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è:**
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: title, description, date_start, date_end, location
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ slug
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ date_end > date_start
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (numeric)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞
- ‚úÖ –í—Å–µ JSON –ø–æ–ª—è (features, schedule, infrastructure) –∫–∞–∫ array

### UpdateEventRequest

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è:**
- ‚úÖ –í—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã (sometimes)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ slug —Å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–π –∑–∞–ø–∏—Å–∏
- ‚úÖ –¢–µ –∂–µ –ø—Ä–∞–≤–∏–ª–∞, —á—Ç–æ –∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

### StoreTripRequest

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏:**
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: event_id, city_from, departure_time, price, seats_total
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è (exists:events,id)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ arrival_time > departure_time
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ seats_taken <= seats_total
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è transport_type (enum: bus, minibus, car, train, plane)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è status (enum: active, cancelled, completed)
- ‚úÖ –í—Å–µ JSON –ø–æ–ª—è –∫–∞–∫ array

### UpdateTripRequest

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏:**
- ‚úÖ –í—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã (sometimes)
- ‚úÖ –¢–µ –∂–µ –ø—Ä–∞–≤–∏–ª–∞, —á—Ç–æ –∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è

### StoreBookingRequest

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: trip_id, user_name, user_phone, user_email, seats
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏ (exists:trips,id)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è email
- ‚úÖ –ú–∏–Ω–∏–º—É–º 1 –º–µ—Å—Ç–æ (min:1)

### UpdateBookingStatusRequest

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:**
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ: status
- ‚úÖ Enum –≤–∞–ª–∏–¥–∞—Ü–∏—è (pending, confirmed, cancelled)

## üéÆ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã

### –î–æ (–±—ã–ª–æ):

```php
public function store(Request $request): JsonResponse
{
    $validated = $request->validate([
        'title' => 'required|string|max:255',
        'subtitle' => 'nullable|string|max:255',
        'slug' => 'nullable|string|max:255|unique:events,slug',
        'description' => 'required|string',
        // ... –µ—â–µ 20+ —Å—Ç—Ä–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    ]);

    $event = $this->eventService->create($validated);

    return response()->json(['data' => $event], 201);
}
```

### –ü–æ—Å–ª–µ (—Å—Ç–∞–ª–æ):

```php
public function store(StoreEventRequest $request): JsonResponse
{
    $event = $this->eventService->create($request->validated());

    return response()->json(['data' => $event], 201);
}
```

**–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å—Ç–∞–ª –≤ 10 —Ä–∞–∑ –∫–æ—Ä–æ—á–µ!** üéâ

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. –ß–∏—Å—Ç—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —Å—Ç–∞–ª–∏ —Ç–æ–Ω—å—à–µ
- ‚úÖ –§–æ–∫—É—Å —Ç–æ–ª—å–∫–æ –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ
- ‚úÖ –õ–µ–≥—á–µ —á–∏—Ç–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

### 2. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

### 3. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ
- ‚úÖ –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏–∑–º–µ–Ω–∏—Ç—å
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞

### 4. –†—É—Å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

### 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ Laravel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç 422 —Å –æ—à–∏–±–∫–∞–º–∏
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

## üîÑ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è

**Request:**
```http
POST /api/v1/events
Content-Type: application/json

{
  "title": "Padel Camp Valencia",
  "description": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –ª–∞–≥–µ—Ä—å",
  "date_start": "2024-06-01",
  "date_end": "2024-05-30",  // ‚ùå –û—à–∏–±–∫–∞!
  "location": "Valencia, Spain"
}
```

**Response (422):**
```json
{
  "message": "The given data was invalid.",
  "errors": {
    "date_end": [
      "–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–∑–∂–µ –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞"
    ]
  }
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**Request:**
```http
POST /api/v1/bookings
Content-Type: application/json

{
  "trip_id": 999,  // ‚ùå –ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  "user_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "user_phone": "+7 999 123 45 67",
  "user_email": "invalid-email",  // ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π email
  "seats": 0  // ‚ùå –ú–∏–Ω–∏–º—É–º 1
}
```

**Response (422):**
```json
{
  "message": "The given data was invalid.",
  "errors": {
    "trip_id": [
      "–í—ã–±—Ä–∞–Ω–Ω–∞—è –ø–æ–µ–∑–¥–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    ],
    "user_email": [
      "The user email must be a valid email address."
    ],
    "seats": [
      "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º 1 –º–µ—Å—Ç–æ"
    ]
  }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

Form Request –∫–ª–∞—Å—Å—ã –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

```php
use Tests\TestCase;
use App\Http\Requests\StoreEventRequest;

class StoreEventRequestTest extends TestCase
{
    public function test_validates_required_fields()
    {
        $request = new StoreEventRequest();
        
        $validator = Validator::make([], $request->rules());
        
        $this->assertTrue($validator->fails());
        $this->assertArrayHasKey('title', $validator->errors()->toArray());
    }
    
    public function test_validates_date_order()
    {
        $request = new StoreEventRequest();
        
        $validator = Validator::make([
            'date_start' => '2024-06-01',
            'date_end' => '2024-05-30',
        ], $request->rules());
        
        $this->assertTrue($validator->fails());
        $this->assertArrayHasKey('date_end', $validator->errors()->toArray());
    }
}
```

## üìù –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Request (JSON)
    ‚Üì
Form Request (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
    ‚Üì validated()
Controller (—Ç–æ–Ω–∫–∏–π —Å–ª–æ–π)
    ‚Üì
Service (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
    ‚Üì
Repository (–ë–î)
```

## ‚ú® –ò—Ç–æ–≥

### –°–æ–∑–¥–∞–Ω–æ:
- ‚úÖ 6 Form Request –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö API endpoints
- ‚úÖ –†—É—Å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –û–±–Ω–æ–≤–ª–µ–Ω–æ:
- ‚úÖ EventController (store, update)
- ‚úÖ TripController (store, update)
- ‚úÖ BookingController (store, updateStatus)

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —Å—Ç–∞–ª–∏ –≤ 10 —Ä–∞–∑ –∫–æ—Ä–æ—á–µ
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ –ö–æ–¥ –ª–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

---

**–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã! –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã —Å—Ç–∞–ª–∏ –µ—â–µ —Ç–æ–Ω—å—à–µ!** ‚ú®

